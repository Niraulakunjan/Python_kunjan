<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Loops Tutorial & Quiz</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-blue: #1877F2;
            --secondary-blue: #4267B2;
            --accent-blue: #2D88FF;
            --dark-bg: #1a1a1a;
            --darker-bg: #0a0a0a;
            --text-color: #ffffff;
            --bg-light: #242526;
            --text-light: #E4E6EB;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark-bg);
            color: var(--text-color);
            line-height: 1.6;
        }

        header {
            text-align: center;
            padding: 2rem;
            background: var(--darker-bg);
            border-bottom: 1px solid rgba(45, 136, 255, 0.1);
        }

        header h1 {
            color: var(--accent-blue);
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        header p {
            color: var(--text-light);
            font-size: 1.2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .content {
            background: var(--bg-light);
            border-radius: 20px;
            padding: 2.5rem;
            margin-top: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--darker-bg);
            border-radius: 12px;
            border-left: 4px solid var(--accent-blue);
        }

        .section h2, .section h3 {
            color: var(--accent-blue);
            margin-bottom: 1rem;
        }

        .section p {
            margin-bottom: 1rem;
        }

        .loop-table-container {
            overflow-x: auto;
            margin: 1rem 0;
        }

        .loop-table {
            width: 100%;
            border-collapse: collapse;
        }

        .loop-table th, .loop-table td {
            padding: 0.8rem;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .loop-table th {
            background: rgba(0, 0, 0, 0.2);
            color: var(--accent-blue);
        }

        .code {
            background: rgba(0, 0, 0, 0.3);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: monospace;
            color: #f8f8f2;
        }

        .code-container {
            position: relative;
            margin: 1.5rem 0;
        }

        .code-block {
            background: #2d2d2d;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
        }

        .copy-btn {
            position: absolute;
            right: 0.5rem;
            top: 0.5rem;
            background: var(--accent-blue);
            border: none;
            color: white;
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .btn {
            background: var(--accent-blue);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--primary-blue);
            transform: translateY(-2px);
        }

        .reset-btn {
            background: #ff4444;
            margin-top: 1rem;
        }

        .reset-btn:hover {
            background: #cc0000;
        }

        .quiz-question {
            margin: 1.5rem 0;
        }

        .quiz-question p {
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .quiz-options label {
            background: rgba(24, 119, 242, 0.1);
            padding: 0.5rem;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .quiz-options label:hover {
            background: rgba(24, 119, 242, 0.2);
        }

        .result {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 8px;
            display: none;
        }

        .correct {
            background: rgba(0, 255, 0, 0.2);
            border-left: 3px solid green;
        }

        .incorrect {
            background: rgba(255, 0, 0, 0.2);
            border-left: 3px solid red;
        }

        textarea.code-input {
            width: 100%;
            min-height: 100px;
            background: #2d2d2d;
            color: var(--text-color);
            border: 1px solid rgba(45, 136, 255, 0.2);
            border-radius: 8px;
            padding: 1rem;
            font-family: 'Courier New', Courier, monospace;
            resize: vertical;
            margin-bottom: 1rem;
        }

        ul {
            list-style-type: disc;
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        canvas {
            max-width: 100%;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <header>
        <h1><i class="fab fa-python"></i> Python Loops</h1>
        <p>Complete guide to Python's loop structures</p>
    </header>

    <div class="container">
        <div class="content">
            <div class="section">
                <h2>Loop Basics</h2>
                <p>Loops in Python (`for` and `while`) allow repetitive execution of code blocks. `for` loops iterate over sequences, while `while` loops run as long as a condition is true.</p>
                <div class="code-container">
                    <div class="code-block">
                        <pre>
# Basic for loop
for i in range(5):
    print(i)
# Output: 0 1 2 3 4

# Basic while loop
count = 0
while count < 5:
    print(count)
    count += 1
# Output: 0 1 2 3 4
                        </pre>
                    </div>
                    <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                </div>
                <p>Key characteristics:</p>
                <ul>
                    <li>Iteration: `for` loops are ideal for known sequences (e.g., lists, ranges); `while` loops are used for condition-based repetition.</li>
                    <li>Control flow: Use `break` to exit a loop, `continue` to skip an iteration.</li>
                    <li>Indentation: Loop bodies must be indented (typically 4 spaces).</li>
                    <li>Nested loops: Loops can be nested for complex iterations (e.g., iterating over a 2D list).</li>
                </ul>
            </div>

            <div class="section">
                <h2>Loop Examples</h2>
                <p>Loops support various patterns for repetitive tasks:</p>
                <div class="loop-table-container">
                    <table class="loop-table">
                        <tr><th>Pattern</th><th>Description</th><th>Example</th></tr>
                        <tr><td class="code">for</td><td>Iterate over sequence</td><td class="code">for x in [1, 2, 3]: print(x)</td></tr>
                        <tr><td class="code">while</td><td>Run until condition is false</td><td class="code">while x < 5: x += 1</td></tr>
                        <tr><td class="code">break</td><td>Exit loop early</td><td class="code">for x in range(10): if x == 5: break</td></tr>
                        <tr><td class="code">continue</td><td>Skip current iteration</td><td class="code">for x in range(5): if x == 2: continue</td></tr>
                        <tr><td class="code">Nested loops</td><td>Loop within a loop</td><td class="code">for i in range(3): for j in range(2): print(i, j)</td></tr>
                    </table>
                </div>
                <div class="code-container">
                    <div class="code-block">
                        <pre>
# For loop with break
for i in range(10):
    if i == 5:
        break
    print(i)
# Output: 0 1 2 3 4

# While loop with continue
count = 0
while count < 5:
    count += 1
    if count == 3:
        continue
    print(count)
# Output: 1 2 4 5

# Nested loop example
for i in range(3):
    for j in range(2):
        print(f"i={i}, j={j}")
# Output: i=0, j=0  i=0, j=1  i=1, j=0  i=1, j=1  i=2, j=0  i=2, j=1
                        </pre>
                    </div>
                    <button class="copy-btn" onclick="copyCode(this)" aria-label="Copy code">Copy</button>
                </div>
                <h3>Visualizing Loop Iterations</h3>
                <p>Below is a line chart showing the value of a counter over iterations in a loop.</p>
                <canvas id="loopChart" aria-label="Line chart of loop iterations"></canvas>
            </div>

            <div class="section">
                <h2>Python Loops Exercises (Quiz)</h2>
                <h3>Test Your Knowledge</h3>
                <button class="btn reset-btn" onclick="resetQuiz()" aria-label="Reset quiz answers">Reset Quiz</button>

                <!-- Question 1: Multiple Choice -->
                <div class="quiz-question">
                    <p id="q1-label">1. What will be the output of the following code?</p>
                    <div class="code-block">
                        <pre>
for i in range(3):
    print(i)
                        </pre>
                    </div>
                    <div class="quiz-options" role="radiogroup" aria-labelledby="q1-label">
                        <label><input type="radio" name="q1" value="a" aria-label="Option a"> a) 0 1 2</label>
                        <label><input type="radio" name="q1" value="b" aria-label="Option b"> b) 1 2 3</label>
                        <label><input type="radio" name="q1" value="c" aria-label="Option c"> c) 0 1 2 3</label>
                        <label><input type="radio" name="q1" value="d" aria-label="Option d"> d) Error</label>
                    </div>
                    <button class="btn" onclick="checkAnswer('q1', 'a', this)" aria-label="Check answer for question 1">Check Answer</button>
                    <div class="result" role="alert"></div>
                </div>

                <!-- Question 2: True/False -->
                <div class="quiz-question">
                    <p id="q2-label">2. A `while` loop will always execute at least once.</p>
                    <div class="quiz-options" role="radiogroup" aria-labelledby="q2-label">
                        <label><input type="radio" name="q2" value="true" aria-label="True"> True</label>
                        <label><input type="radio" name="q2" value="false" aria-label="False"> False</label>
                    </div>
                    <button class="btn" onclick="checkAnswer('q2', 'false', this)" aria-label="Check answer for question 2">Check Answer</button>
                    <div class="result" role="alert"></div>
                </div>

                <!-- Question 3: Multiple Choice -->
                <div class="quiz-question">
                    <p id="q3-label">3. What will be the output of the following code?</p>
                    <div class="code-block">
                        <pre>
count = 0
while count < 3:
    print(count)
    count += 1
                        </pre>
                    </div>
                    <div class="quiz-options" role="radiogroup" aria-labelledby="q3-label">
                        <label><input type="radio" name="q3" value="a" aria-label="Option a"> a) 0 1 2</label>
                        <label><input type="radio" name="q3" value="b" aria-label="Option b"> b) 1 2 3</label>
                        <label><input type="radio" name="q3" value="c" aria-label="Option c"> c) 0 1 2 3</label>
                        <label><input type="radio" name="q3" value="d" aria-label="Option d"> d) Infinite loop</label>
                    </div>
                    <button class="btn" onclick="checkAnswer('q3', 'a', this)" aria-label="Check answer for question 3">Check Answer</button>
                    <div class="result" role="alert"></div>
                </div>

                <!-- Question 4: Multiple Choice -->
                <div class="quiz-question">
                    <p id="q4-label">4. What will the following code do?</p>
                    <div class="code-block">
                        <pre>
for i in range(5):
    if i == 2:
        continue
    print(i)
                        </pre>
                    </div>
                    <div class="quiz-options" role="radiogroup" aria-labelledby="q4-label">
                        <label><input type="radio" name="q4" value="a" aria-label="Option a"> a) Print 0 1 3 4</label>
                        <label><input type="radio" name="q4" value="b" aria-label="Option b"> b) Print 0 1 2 3 4</label>
                        <label><input type="radio" name="q4" value="c" aria-label="Option c"> c) Print 2</label>
                        <label><input type="radio" name="q4" value="d" aria-label="Option d"> d) Error</label>
                    </div>
                    <button class="btn" onclick="checkAnswer('q4', 'a', this)" aria-label="Check answer for question 4">Check Answer</button>
                    <div class="result" role="alert"></div>
                </div>

                <!-- Question 5: Coding Challenge -->
                <div class="quiz-question">
                    <p id="q5-label">5. Write a Python code snippet using a for loop to print the numbers from 1 to 5.</p>
                    <div class="code-container">
                        <textarea class="code-input" id="codeInput" placeholder="Enter your Python code here..." aria-label="Enter your Python code"></textarea>
                    </div>
                    <button class="btn" onclick="checkCodeAnswer(this)" aria-label="Check code answer">Submit Code</button>
                    <div class="result" role="alert"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Object to store timeout IDs for buttons to prevent overlapping timeouts
        const copyTimeouts = new Map();

        /**
         * Copies the text of the nearest code block to the clipboard.
         * @param {HTMLButtonElement} button - The copy button clicked.
         */
        function copyCode(button) {
            const codeBlock = button.previousElementSibling?.querySelector('pre');
            if (!codeBlock) {
                console.error('No code block found for copying.');
                alert('Error: No code block found.');
                return;
            }

            navigator.clipboard.writeText(codeBlock.textContent).then(() => {
                if (copyTimeouts.has(button)) {
                    clearTimeout(copyTimeouts.get(button));
                }
                button.textContent = 'Copied!';
                const timeoutId = setTimeout(() => {
                    button.textContent = 'Copy';
                    copyTimeouts.delete(button);
                }, 2000);
                copyTimeouts.set(button, timeoutId);
            }).catch(err => {
                console.error('Failed to copy text: ', err);
                button.textContent = 'Error';
                setTimeout(() => button.textContent = 'Copy', 2000);
                alert('Failed to copy code.');
            });
        }

        /**
         * Checks the selected answer for a quiz question and displays feedback.
         * @param {string} questionName - The name attribute of the radio inputs.
         * @param {string} correctAnswer - The correct answer value.
         * @param {HTMLButtonElement} button - The check answer button clicked.
         */
        function checkAnswer(questionName, correctAnswer, button) {
            if (button.disabled) return;
            button.disabled = true;

            const selected = document.querySelector(`input[name="${questionName}"]:checked`);
            const resultDiv = button.nextElementSibling;

            if (!resultDiv) {
                console.error('Result div not found for question:', questionName);
                button.disabled = false;
                alert('Error: Unable to display result.');
                return;
            }

            resultDiv.style.display = 'block';
            if (selected) {
                if (selected.value === correctAnswer) {
                    resultDiv.className = 'result correct';
                    resultDiv.textContent = 'Correct! ' + getExplanation(questionName);
                } else {
                    resultDiv.className = 'result incorrect';
                    resultDiv.textContent = 'Incorrect. ' + getExplanation(questionName);
                }
            } else {
                resultDiv.className = 'result incorrect';
                resultDiv.textContent = 'Please select an answer.';
            }

            setTimeout(() => {
                button.disabled = false;
            }, 2000);
        }

        /**
         * Provides explanations for quiz questions.
         * @param {string} questionName - The name attribute of the question.
         * @returns {string} Explanation for the question.
         */
        function getExplanation(questionName) {
            const explanations = {
                q1: 'range(3) generates 0, 1, 2, so the for loop prints 0 1 2. See the Loop Basics section for details.',
                q2: 'A while loop may not execute if its condition is initially false. See the Loop Basics section for details.',
                q3: 'The while loop runs while count < 3, printing 0 1 2 as count increments. See the Loop Examples section for details.',
                q4: 'The continue statement skips i=2, so the loop prints 0 1 3 4. See the Loop Examples section for details.'
            };
            return explanations[questionName] || 'No explanation available.';
        }

        /**
         * Validates the user's code for the coding challenge.
         * @param {HTMLButtonElement} button - The submit button clicked.
         */
        function checkCodeAnswer(button) {
            if (button.disabled) return;
            button.disabled = true;

            const resultDiv = button.nextElementSibling;
            const codeInput = document.getElementById('codeInput');
            if (!resultDiv || !codeInput) {
                console.error('Result div or code input not found.');
                button.disabled = false;
                alert('Error: Unable to process code.');
                return;
            }

            const userCode = codeInput.value.trim();
            resultDiv.style.display = 'block';

            // Improved validation checks
            const hasFor = /for\s+\w+\s+in\s+range\s*\([^)]+\)\s*:/i.test(userCode);
            const hasPrint = /print\s*\(\s*[^)]+\s*\)/g.test(userCode);
            const printCount = (userCode.match(/print\s*\(\s*[^)]+\s*\)/g) || []).length;
            const hasRange = /range\s*\(\s*(?:5|1\s*,\s*6)\s*\)/i.test(userCode);
            const printsCorrectVar = /print\s*\(\s*\w+\s*\)/i.test(userCode);

            if (userCode === '') {
                resultDiv.className = 'result incorrect';
                resultDiv.textContent = 'Please enter some code.';
            } else if (hasFor && hasPrint && printCount >= 1 && hasRange && printsCorrectVar) {
                // Basic output validation
                try {
                    const lines = userCode.split('\n');
                    let loopVar = '';
                    let rangeEnd = 0;
                    for (let line of lines) {
                        line = line.trim();
                        if (line.match(/for\s+(\w+)\s+in\s+range\s*\(\s*(\d+)\s*\)\s*:/i)) {
                            loopVar = RegExp.$1;
                            rangeEnd = parseInt(RegExp.$2);
                        } else if (line.match(/for\s+(\w+)\s+in\s+range\s*\(\s*1\s*,\s*(\d+)\s*\)\s*:/i)) {
                            loopVar = RegExp.$1;
                            rangeEnd = parseInt(RegExp.$2) - 1;
                        }
                        if (line.match(/print\s*\(\s*[^)]+\s*\)/)) {
                            if (!line.includes(loopVar)) {
                                throw new Error('Print does not use loop variable.');
                            }
                        }
                    }
                    if (rangeEnd === 5 && userCode.match(/print\s*\(\s*${loopVar}\s*\)/i)) {
                        resultDiv.className = 'result correct';
                        resultDiv.textContent = 'Correct! Your code uses a for loop to print numbers 1 to 5.';
                    } else {
                        resultDiv.className = 'result incorrect';
                        resultDiv.textContent = `Incorrect. Expected a for loop printing 1 to 5, but found range ending at ${rangeEnd}. Try this:\nfor i in range(1, 6):\n    print(i)`;
                    }
                } catch (e) {
                    resultDiv.className = 'result incorrect';
                    resultDiv.textContent = 'Incorrect. Invalid code structure. Try this:\nfor i in range(1, 6):\n    print(i)';
                }
            } else {
                resultDiv.className = 'result incorrect';
                let feedback = 'Incorrect. Your code is missing one or more required elements:\n';
                if (!hasFor) feedback += '- A for loop\n';
                if (!hasPrint) feedback += `- At least one print() statement (found ${printCount})\n`;
                if (!hasRange) feedback += '- A range(5) or range(1, 6) in the for loop\n';
                if (!printsCorrectVar) feedback += '- Printing the loop variable\n';
                feedback += '\nTry this:\nfor i in range(1, 6):\n    print(i)';
                resultDiv.textContent = feedback;
            }

            setTimeout(() => {
                button.disabled = false;
            }, 2000);
        }

        /**
         * Resets all quiz answers and clears feedback.
         */
        function resetQuiz() {
            document.querySelectorAll('input[type="radio"]').forEach(input => {
                input.checked = false;
            });
            document.querySelector('#codeInput').value = '';
            document.querySelectorAll('.result').forEach(div => {
                div.style.display = 'none';
                div.textContent = '';
                div.className = 'result';
            });
            document.querySelectorAll('.btn').forEach(btn => {
                btn.disabled = false;
            });
        }

        /**
         * Initializes Chart.js for loop iterations visualization.
         */
        document.addEventListener('DOMContentLoaded', () => {
            const ctx = document.getElementById('loopChart')?.getContext('2d');
            if (ctx) {
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Iteration 1', 'Iteration 2', 'Iteration 3', 'Iteration 4', 'Iteration 5'],
                        datasets: [{
                            label: 'Counter Value',
                            data: [1, 2, 3, 4, 5],
                            borderColor: '#36A2EB',
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            fill: true,
                            tension: 0.1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: { display: true, text: 'Counter Value' }
                            }
                        },
                        plugins: {
                            legend: { display: true, position: 'top' },
                            title: { display: true, text: 'Counter in a For Loop (1 to 5)' }
                        }
                    }
                });
            }
        });
    </script>
</body>
</html>
